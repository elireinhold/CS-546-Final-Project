<h1>Search Events</h1>

<form method="GET" action="/events/search">
  
  <!-- Keyword -->
  <input 
    type="text" 
    name="keyword" 
    placeholder="Search by event name" 
    value="{{keyword}}"
  />

  <!-- Borough Dropdown -->
  <select name="borough">
    <option value="all" {{#ifEquals borough "all"}}selected{{/ifEquals}}>All Boroughs</option>
    
    {{#each boroughs}}
      <option value="{{this}}" {{#ifEquals ../borough this}}selected{{/ifEquals}}>
        {{this}}
      </option>
    {{/each}}
  </select>

  <!-- Event Type Dropdown -->
  <select name="eventType">
    <option value="all" {{#ifEquals eventType "all"}}selected{{/ifEquals}}>All Types</option>

    {{#each eventTypes}}
      <option value="{{this}}" {{#ifEquals this ../eventType}}selected{{/ifEquals}}>
        {{this}}
      </option>
    {{/each}}
  </select>

  <button type="submit">Search</button>
</form>

<hr>

<!-- Results -->
{{#if results.length}}
  <ul>
    {{#each results}}
      <li>
        <a href="/events/{{this._id}}">{{this.eventName}}</a>
        â€” {{this.eventBorough}}

        <!-- Save Count -->
        <div id="save-count-{{this._id}}">
          {{this.userCount}} user(s) saved this
        </div>

        <!-- Save / Unsave Button -->
        {{#if this.saved}}
          <button 
            id="save-btn-{{this._id}}" 
            onclick="updateSaveStatus('{{this._id}}', true)"
          >
            Unsave
          </button>
        {{else}}
          <button 
            id="save-btn-{{this._id}}" 
            onclick="updateSaveStatus('{{this._id}}', false)"
          >
            Save
          </button>
        {{/if}}

      </li>
    {{/each}}
  </ul>
{{else}}
  <p>No events found.</p>
{{/if}}

<script src="/public/js/search.js"></script>